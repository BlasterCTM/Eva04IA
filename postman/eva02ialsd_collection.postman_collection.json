{
  "info": {
    "name": "EVA02IALSD - API Minimal",
    "_postman_id": "e0f6a6c6-0000-4000-8000-000000000000",
    "description": "Colección para probar endpoints de la API (versionado de modelo, predict, reports, plots, retrain).",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000"
    },
    {
      "key": "api_key",
      "value": "testkey"
    },
    {
      "key": "activate_version",
      "value": ""
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Añade header x-api-key a cada request si la variable 'api_key' está definida",
          "if (pm && pm.variables && pm.variables.get('api_key')) {",
          "  var k = 'x-api-key';",
          "  var v = pm.variables.get('api_key');",
          "  try { pm.request.headers.upsert({ key: k, value: v }); } catch (e) { pm.request.headers.add({ key: k, value: v }); }",
          "}"
        ]
      }
    }
  ],
  "item": [
    {
      "name": "Root",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/",
          "host": ["{{base_url}}"],
          "path": ["/"]
        }
      }
    },
    {
      "name": "Health",
      "request": {
        "method": "GET",
        "header": [],
        "url": { "raw": "{{base_url}}/health", "host": ["{{base_url}}"], "path": ["health"] }
      }
    },
    {
      "name": "Model - Registry (versions)",
      "request": {
        "method": "GET",
        "header": [],
        "url": { "raw": "{{base_url}}/model/versions", "host": ["{{base_url}}"], "path": ["model","versions"] }
      }
    },
    {
      "name": "Model - Metadata (legacy)",
      "request": {
        "method": "GET",
        "header": [],
        "url": { "raw": "{{base_url}}/model/version", "host": ["{{base_url}}"], "path": ["model","version"] }
      }
    },
    {
      "name": "Model - Activate",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "x-api-key", "value": "{{api_key}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"version\": \"{{activate_version}}\"\n}"
        },
        "url": { "raw": "{{base_url}}/model/activate", "host": ["{{base_url}}"], "path": ["model","activate"] }
      }
    },
    {
      "name": "Model - Reload",
      "request": {
        "method": "POST",
        "header": [ { "key": "x-api-key", "value": "{{api_key}}" } ],
        "url": { "raw": "{{base_url}}/model/reload", "host": ["{{base_url}}"], "path": ["model","reload"] }
      }
    },
    {
      "name": "Predict - sample",
      "request": {
        "method": "POST",
        "header": [ { "key": "Content-Type", "value": "application/json" }, { "key": "x-api-key", "value": "{{api_key}}" } ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"records\": [\n    {\n      \"Date\": \"2025-12-16\",\n      \"Units Sold\": 10,\n      \"Product\": \"SKU123\",\n      \"Store\": \"S1\"\n    }\n  ]\n}"
        },
        "url": { "raw": "{{base_url}}/predict", "host": ["{{base_url}}"], "path": ["predict"] }
      }
    },
    {
      "name": "Reports - Detail",
      "request": {
        "method": "GET",
        "header": [],
        "url": { "raw": "{{base_url}}/reports/detail?rows=10", "host": ["{{base_url}}"], "path": ["reports","detail"], "query": [ { "key": "rows", "value": "10" } ] }
      }
    },
    {
      "name": "Reports - Season",
      "request": {
        "method": "GET",
        "header": [],
        "url": { "raw": "{{base_url}}/reports/season", "host": ["{{base_url}}"], "path": ["reports","season"] }
      }
    },
    {
      "name": "Plots - List",
      "request": {
        "method": "GET",
        "header": [],
        "url": { "raw": "{{base_url}}/plots", "host": ["{{base_url}}"], "path": ["plots"] }
      }
    },
    {
      "name": "Retrain (background)",
      "request": {
        "method": "POST",
        "header": [ { "key": "x-api-key", "value": "{{api_key}}" } ],
        "url": { "raw": "{{base_url}}/retrain", "host": ["{{base_url}}"], "path": ["retrain"] }
      }
    }
  ]
}
